<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<dom-module id="dp-rating-star">
    <template>
        <style include="dp-styles">
            :host {
                display: block;
                position: relative;                
                text-align: center;
                /*font-size: inherit;*/
                color: #fff;
                --my-color: linear-gradient(to right, red, white 0%);
            }
            :host(.inline) {
                display: inline-block;
            }
            :host > div {
                display: block;
            }

            :host(.inline) > div {
                display: inline-block;
                vertical-align: middle;
            }

            .rating-star .md-icon {
                font-size: 2em;
            }

            .rating-text {
                font-size: 1.125em;
            }

            :host(.inline) .rating-text {
                font-size: 1.4em;
            }
            .rating-star .md-icon {
                display: block;
                position: relative;
                color: #fff;
                background: #000;
                mix-blend-mode: lighten;
            }

                .rating-star .md-icon::before {
                    mix-blend-mode: multiply;
                }

                .rating-star .md-icon::before {
                    content: '';
                    display: block;
                    position: absolute;
                    top: 0;
                    right: 0;
                    bottom: 0;
                    left: 0;
                    /*30, 50, 62, 70, 80 */
                    background: var(--my-color); /*1: 0,2: 60, 3: 70, 4: 80, 5: 110*/
                    /*background: var(--my-color);*/
                    /*background: linear-gradient(to right bottom, yellow 50%, white 50%);*/
                    /*background: -webkit-linear-gradient(left,#23966c, #faaa54, #e23b4a, #db0768, #360670);
                    background: linear-gradient(to right,#23966c, #faaa54, #e23b4a, #db0768, #360670);*/
                    pointer-events: none;
                }
        </style>
        <div class="rating-star">
            <i id="iconStar" class="md-icon">star</i>
        </div>
        <div class="rating-text">
            [[value]]
        </div>
    </template>
    <script>
        class DpRatingStar extends Polymer.Element {
            static get is() { return 'dp-rating-star'; }
            static get properties() {
                return {
                    value: String
                };
            }
            static get observers() {
                return ['_onValueChange(value)'];
            }
            _calColorRatio(value) {
                let pct = 0;
                if (value <= 0) { pct = 0; }
                else if (value < 0.5) { pct = 30; }
                else if (value < 1) { pct = 40; }
                else if (value < 1.5) { pct = 50; }
                else if (value < 2) { pct = 55; }
                else if (value < 2.5) { pct = 65; }
                else if (value < 3) { pct = 70; }
                else if (value < 3.5) { pct = 70; }
                else if (value < 4) { pct = 75; }
                else if (value < 4.5) { pct = 90; }
                else if (value < 5) { pct = 100; }
                else { pct = 160; }
                return pct;
            }
            _onValueChange(value) {
                value = Number(value);
                const pct = this._calColorRatio(value);
                this.updateStyles({
                    '--my-color':
                    `linear-gradient(to right bottom, red, white ${pct}%)`,
                });
            }
        }

        window.customElements.define(DpRatingStar.is, DpRatingStar);
    </script>
</dom-module>
